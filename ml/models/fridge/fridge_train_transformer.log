2023-12-02 05:56:33,559 [INFO ]  *** Training model from scratch ***
2023-12-02 05:56:33,559 [INFO ]  Machine name: titan
2023-12-02 05:56:33,559 [INFO ]  Arguments: 
2023-12-02 05:56:33,559 [INFO ]  Namespace(appliance_name='fridge', model_arch='transformer', datadir='./dataset_management/refit', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=None, crop_val_dataset=None, do_not_use_distributed_training=False, resume_training=False, plot_display=False)
2023-12-02 05:56:33,559 [INFO ]  Window length: 599
2023-12-02 05:56:33,559 [INFO ]  Training dataset: ./dataset_management/refit/fridge/fridge_training_.csv
2023-12-02 05:56:33,559 [INFO ]  Validation dataset: ./dataset_management/refit/fridge/fridge_validation_H12.csv
2023-12-02 05:56:33,559 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/fridge/checkpoints_transformer
2023-12-02 05:56:33,559 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/fridge/savemodel_transformer
2023-12-02 05:56:33,559 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/fridge/history_transformer
2023-12-02 05:56:37,663 [INFO ]  There are 19.334M training samples.
2023-12-02 05:56:37,663 [INFO ]  There are 5.860M validation samples.
2023-12-02 05:56:37,663 [INFO ]  Normalized on power threshold: 0.125
2023-12-02 05:56:37,663 [INFO ]  L1 loss multiplier: 1e-06
2023-12-02 05:56:37,663 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2023-12-02 05:56:37,834 [INFO ]  Number of replicas: 2.
2023-12-02 05:56:37,834 [INFO ]  Global batch size: 1024.
2023-12-02 05:56:38,685 [INFO ]  Learning rate: 0.0001
2023-12-02 05:56:40,454 [INFO ]  Collective all_reduce tensors: 46 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-02 05:56:41,913 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:42,885 [INFO ]  Collective all_reduce tensors: 46 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-02 05:56:43,188 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:49,900 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:49,904 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:49,907 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:49,908 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:50,136 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:50,137 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:50,138 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 05:56:50,138 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-02 07:06:54,155 [INFO ]  Running test loop after epoch: 1.
2023-12-02 07:16:15,456 [INFO ]  Current val loss of 3.691 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/fridge/savemodel_transformer.
2023-12-02 07:16:17,820 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/fridge/savemodel_transformer/assets
2023-12-02 07:16:17,869 [INFO ]  epoch: 1 loss: 2.752 mse: 0.009837 mae: 0.06293 val_loss: 3.691 val_mse: 0.009493 val_mae: 0.07061
2023-12-02 07:16:18,067 [INFO ]  Reshuffling training dataset.
2023-12-02 08:26:32,217 [INFO ]  Running test loop after epoch: 2.
2023-12-02 08:35:53,893 [INFO ]  Current val loss of 3.415 < than val loss of 3.691, saving model to /home/lindo/Develop/nilm/ml/models/fridge/savemodel_transformer.
2023-12-02 08:35:56,205 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/fridge/savemodel_transformer/assets
2023-12-02 08:35:56,254 [INFO ]  epoch: 2 loss: 1.756 mse: 0.005915 mae: 0.04398 val_loss: 3.415 val_mse: 0.009438 val_mae: 0.07192
2023-12-02 08:35:56,550 [INFO ]  Reshuffling training dataset.
2023-12-02 09:46:18,232 [INFO ]  Running test loop after epoch: 3.
2023-12-02 09:55:41,090 [INFO ]  epoch: 3 loss: 1.462 mse: 0.004649 mae: 0.03767 val_loss: 3.429 val_mse: 0.009114 val_mae: 0.06813
2023-12-02 09:55:41,486 [INFO ]  Reshuffling training dataset.
2023-12-02 11:06:09,318 [INFO ]  Running test loop after epoch: 4.
2023-12-02 11:15:32,715 [INFO ]  epoch: 4 loss: 1.253 mse: 0.003885 mae: 0.03355 val_loss: 3.798 val_mse: 0.009874 val_mae: 0.06985
2023-12-02 11:15:33,226 [INFO ]  Reshuffling training dataset.
2023-12-02 12:26:03,122 [INFO ]  Running test loop after epoch: 5.
2023-12-02 12:35:25,345 [INFO ]  epoch: 5 loss: 1.079 mse: 0.003351 mae: 0.03042 val_loss: 3.542 val_mse: 0.009501 val_mae: 0.0701
2023-12-02 12:35:25,973 [INFO ]  Reshuffling training dataset.
2023-12-02 13:45:52,211 [INFO ]  Running test loop after epoch: 6.
2023-12-02 13:55:15,260 [INFO ]  epoch: 6 loss: 0.9258 mse: 0.002932 mae: 0.02782 val_loss: 3.899 val_mse: 0.01028 val_mae: 0.07287
2023-12-02 13:55:16,017 [INFO ]  Reshuffling training dataset.
2023-12-02 15:05:42,077 [INFO ]  Running test loop after epoch: 7.
2023-12-02 15:15:04,751 [INFO ]  epoch: 7 loss: 0.7962 mse: 0.002593 mae: 0.02566 val_loss: 3.789 val_mse: 0.01027 val_mae: 0.07035
2023-12-02 15:15:05,682 [INFO ]  Reshuffling training dataset.
2023-12-02 16:25:35,973 [INFO ]  Running test loop after epoch: 8.
2023-12-02 16:34:59,659 [INFO ]  epoch: 8 loss: 0.6936 mse: 0.002329 mae: 0.02389 val_loss: 3.932 val_mse: 0.01063 val_mae: 0.06932
2023-12-02 16:35:00,695 [INFO ]  Early termination of training.
2023-12-02 16:35:01,322 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/fridge/train_transformer_loss
2023-12-02 16:35:01,621 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/fridge/train_transformer_mae
