2023-12-22 06:57:00,224 [INFO ]  *** Training model from scratch ***
2023-12-22 06:57:00,224 [INFO ]  Machine name: titan
2023-12-22 06:57:00,224 [INFO ]  Arguments: 
2023-12-22 06:57:00,224 [INFO ]  Namespace(appliance_name='microwave', model_arch='transformer', datadir='./dataset_management/refit', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=10000000, crop_val_dataset=None, do_not_use_distributed_training=False, resume_training=False, plot_display=False)
2023-12-22 06:57:00,224 [INFO ]  Window length: 599
2023-12-22 06:57:00,224 [INFO ]  Training dataset: ./dataset_management/refit/microwave/microwave_training_.csv
2023-12-22 06:57:00,224 [INFO ]  Validation dataset: ./dataset_management/refit/microwave/microwave_validation_H17.csv
2023-12-22 06:57:00,224 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/microwave/checkpoints_transformer
2023-12-22 06:57:00,224 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer
2023-12-22 06:57:00,224 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/microwave/history_transformer
2023-12-22 06:57:03,132 [INFO ]  There are 10.000M training samples.
2023-12-22 06:57:03,133 [INFO ]  There are 5.432M validation samples.
2023-12-22 06:57:03,133 [INFO ]  Normalized on power threshold: 0.06666666666666667
2023-12-22 06:57:03,133 [INFO ]  L1 loss multiplier: 1.0
2023-12-22 06:57:03,133 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2023-12-22 06:57:03,294 [INFO ]  Number of replicas: 2.
2023-12-22 06:57:03,294 [INFO ]  Global batch size: 1024.
2023-12-22 06:57:03,673 [INFO ]  Learning rate: 0.0001
2023-12-22 06:57:05,328 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-22 06:57:06,752 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:07,649 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-22 06:57:07,925 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,159 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,164 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,167 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,167 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,391 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,392 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,393 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 06:57:14,394 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-22 07:33:18,935 [INFO ]  Running test loop after epoch: 1.
2023-12-22 07:41:57,235 [INFO ]  Current val loss of 0.07837 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 07:41:59,242 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 07:41:59,289 [INFO ]  epoch: 1 loss: 0.4703 mse: 0.002337 mae: 0.03203 val_loss: 0.07837 val_mse: 0.0008385 val_mae: 0.01209
2023-12-22 07:41:59,425 [INFO ]  Reshuffling training dataset.
2023-12-22 08:18:02,941 [INFO ]  Running test loop after epoch: 2.
2023-12-22 08:26:40,235 [INFO ]  epoch: 2 loss: 0.2457 mse: 0.0007517 mae: 0.01766 val_loss: 0.5428 val_mse: 0.001714 val_mae: 0.02995
2023-12-22 08:26:40,424 [INFO ]  Reshuffling training dataset.
2023-12-22 09:02:42,873 [INFO ]  Running test loop after epoch: 3.
2023-12-22 09:11:19,799 [INFO ]  epoch: 3 loss: 0.2256 mse: 0.0006466 mae: 0.01565 val_loss: 0.3034 val_mse: 0.0007792 val_mae: 0.01157
2023-12-22 09:11:20,058 [INFO ]  Reshuffling training dataset.
2023-12-22 09:47:27,633 [INFO ]  Running test loop after epoch: 4.
2023-12-22 09:56:05,983 [INFO ]  Current val loss of 0.07613 < than val loss of 0.07837, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 09:56:08,106 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 09:56:08,157 [INFO ]  epoch: 4 loss: 0.2185 mse: 0.0005921 mae: 0.01438 val_loss: 0.07613 val_mse: 0.0007817 val_mae: 0.01277
2023-12-22 09:56:08,440 [INFO ]  Reshuffling training dataset.
2023-12-22 10:32:17,864 [INFO ]  Running test loop after epoch: 5.
2023-12-22 10:40:56,113 [INFO ]  Current val loss of 0.0692 < than val loss of 0.07613, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 10:40:58,060 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 10:40:58,106 [INFO ]  epoch: 5 loss: 0.2141 mse: 0.0005607 mae: 0.01321 val_loss: 0.0692 val_mse: 0.0009185 val_mae: 0.02216
2023-12-22 10:40:58,447 [INFO ]  Reshuffling training dataset.
2023-12-22 11:17:04,642 [INFO ]  Running test loop after epoch: 6.
2023-12-22 11:25:43,265 [INFO ]  Current val loss of 0.0673 < than val loss of 0.0692, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 11:25:45,237 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 11:25:45,285 [INFO ]  epoch: 6 loss: 0.2085 mse: 0.0005429 mae: 0.0127 val_loss: 0.0673 val_mse: 0.0006951 val_mae: 0.01455
2023-12-22 11:25:45,699 [INFO ]  Reshuffling training dataset.
2023-12-22 12:01:54,638 [INFO ]  Running test loop after epoch: 7.
2023-12-22 12:10:33,389 [INFO ]  epoch: 7 loss: 0.2057 mse: 0.0005179 mae: 0.012 val_loss: 0.1044 val_mse: 0.0006784 val_mae: 0.009988
2023-12-22 12:10:33,856 [INFO ]  Reshuffling training dataset.
2023-12-22 12:46:46,260 [INFO ]  Running test loop after epoch: 8.
2023-12-22 12:55:25,890 [INFO ]  Current val loss of 0.06249 < than val loss of 0.0673, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 12:55:28,020 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 12:55:28,078 [INFO ]  epoch: 8 loss: 0.2011 mse: 0.0005106 mae: 0.01171 val_loss: 0.06249 val_mse: 0.000752 val_mae: 0.01411
2023-12-22 12:55:28,595 [INFO ]  Reshuffling training dataset.
2023-12-22 13:31:39,031 [INFO ]  Running test loop after epoch: 9.
2023-12-22 13:40:18,305 [INFO ]  epoch: 9 loss: 0.2012 mse: 0.0005287 mae: 0.01198 val_loss: 0.06529 val_mse: 0.0007018 val_mae: 0.01393
2023-12-22 13:40:18,897 [INFO ]  Reshuffling training dataset.
2023-12-22 14:16:32,027 [INFO ]  Running test loop after epoch: 10.
2023-12-22 14:25:12,518 [INFO ]  Current val loss of 0.06119 < than val loss of 0.06249, saving model to /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer.
2023-12-22 14:25:14,696 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/microwave/savemodel_transformer/assets
2023-12-22 14:25:14,784 [INFO ]  epoch: 10 loss: 0.1981 mse: 0.0005179 mae: 0.0115 val_loss: 0.06119 val_mse: 0.0006331 val_mae: 0.007985
2023-12-22 14:25:15,424 [INFO ]  Reshuffling training dataset.
2023-12-22 15:01:23,294 [INFO ]  Running test loop after epoch: 11.
2023-12-22 15:10:02,481 [INFO ]  epoch: 11 loss: 0.1972 mse: 0.0005157 mae: 0.01147 val_loss: 0.337 val_mse: 0.0006762 val_mae: 0.008655
2023-12-22 15:10:03,174 [INFO ]  Reshuffling training dataset.
2023-12-22 15:46:18,417 [INFO ]  Running test loop after epoch: 12.
2023-12-22 15:54:58,396 [INFO ]  epoch: 12 loss: 0.2006 mse: 0.0005092 mae: 0.01106 val_loss: 0.08281 val_mse: 0.0007513 val_mae: 0.01045
2023-12-22 15:54:59,205 [INFO ]  Reshuffling training dataset.
2023-12-22 16:31:10,780 [INFO ]  Running test loop after epoch: 13.
2023-12-22 16:39:50,821 [INFO ]  epoch: 13 loss: 0.2013 mse: 0.0005269 mae: 0.01173 val_loss: 0.06289 val_mse: 0.0008302 val_mae: 0.01593
2023-12-22 16:39:51,683 [INFO ]  Reshuffling training dataset.
2023-12-22 17:16:08,537 [INFO ]  Running test loop after epoch: 14.
2023-12-22 17:24:48,874 [INFO ]  epoch: 14 loss: 0.1988 mse: 0.0005152 mae: 0.01107 val_loss: 0.1434 val_mse: 0.0008488 val_mae: 0.01902
2023-12-22 17:24:49,783 [INFO ]  Reshuffling training dataset.
2023-12-22 18:01:03,375 [INFO ]  Running test loop after epoch: 15.
2023-12-22 18:09:43,711 [INFO ]  epoch: 15 loss: 0.1932 mse: 0.0004959 mae: 0.01086 val_loss: 0.0618 val_mse: 0.0006516 val_mae: 0.01205
2023-12-22 18:09:44,686 [INFO ]  Reshuffling training dataset.
2023-12-22 18:45:58,860 [INFO ]  Running test loop after epoch: 16.
2023-12-22 18:54:39,185 [INFO ]  epoch: 16 loss: 0.193 mse: 0.0004941 mae: 0.01061 val_loss: 0.06535 val_mse: 0.0006575 val_mae: 0.01271
2023-12-22 18:54:40,176 [INFO ]  Early termination of training.
2023-12-22 18:54:40,528 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/microwave/train_transformer_loss
2023-12-22 18:54:40,858 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/microwave/train_transformer_mae
