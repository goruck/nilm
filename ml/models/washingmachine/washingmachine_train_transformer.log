2023-12-03 20:06:43,911 [INFO ]  *** Training model from scratch ***
2023-12-03 20:06:43,911 [INFO ]  Machine name: titan
2023-12-03 20:06:43,911 [INFO ]  Arguments: 
2023-12-03 20:06:43,911 [INFO ]  Namespace(appliance_name='washingmachine', model_arch='transformer', datadir='./dataset_management/refit', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=None, crop_val_dataset=None, do_not_use_distributed_training=False, resume_training=False, plot_display=True)
2023-12-03 20:06:43,911 [INFO ]  Window length: 599
2023-12-03 20:06:43,911 [INFO ]  Training dataset: ./dataset_management/refit/washingmachine/washingmachine_training_.csv
2023-12-03 20:06:43,911 [INFO ]  Validation dataset: ./dataset_management/refit/washingmachine/washingmachine_validation_H18.csv
2023-12-03 20:06:43,911 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/washingmachine/checkpoints_transformer
2023-12-03 20:06:43,911 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer
2023-12-03 20:06:43,911 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/washingmachine/history_transformer
2023-12-03 20:06:51,422 [INFO ]  There are 43.470M training samples.
2023-12-03 20:06:51,422 [INFO ]  There are 5.008M validation samples.
2023-12-03 20:06:51,422 [INFO ]  Normalized on power threshold: 0.008
2023-12-03 20:06:51,422 [INFO ]  L1 loss multiplier: 0.01
2023-12-03 20:06:51,423 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2023-12-03 20:06:51,593 [INFO ]  Number of replicas: 2.
2023-12-03 20:06:51,593 [INFO ]  Global batch size: 1024.
2023-12-03 20:06:53,460 [INFO ]  Learning rate: 0.0001
2023-12-03 20:06:55,229 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-03 20:06:56,616 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:06:57,572 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2023-12-03 20:06:57,865 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,490 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,494 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,497 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,498 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,727 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,728 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,729 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 20:07:04,730 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2023-12-03 22:44:54,659 [INFO ]  Running test loop after epoch: 1.
2023-12-03 22:52:54,651 [INFO ]  Current val loss of 0.09181 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2023-12-03 22:52:56,944 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2023-12-03 22:52:56,995 [INFO ]  epoch: 1 loss: 1.82 mse: 0.002234 mae: 0.01105 val_loss: 0.09181 val_mse: 0.0001785 val_mae: 0.002035
2023-12-03 22:52:57,322 [INFO ]  Reshuffling training dataset.
2023-12-04 01:30:46,141 [INFO ]  Running test loop after epoch: 2.
2023-12-04 01:38:45,210 [INFO ]  Current val loss of 0.07203 < than val loss of 0.09181, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2023-12-04 01:38:47,470 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2023-12-04 01:38:47,517 [INFO ]  epoch: 2 loss: 0.5224 mse: 0.001361 mae: 0.006181 val_loss: 0.07203 val_mse: 0.000195 val_mae: 0.002479
2023-12-04 01:38:48,084 [INFO ]  Reshuffling training dataset.
2023-12-04 04:16:37,019 [INFO ]  Running test loop after epoch: 3.
2023-12-04 04:24:36,606 [INFO ]  epoch: 3 loss: 0.4317 mse: 0.001125 mae: 0.00543 val_loss: 0.3243 val_mse: 0.0002074 val_mae: 0.004504
2023-12-04 04:24:37,493 [INFO ]  Reshuffling training dataset.
2023-12-04 07:02:13,964 [INFO ]  Running test loop after epoch: 4.
2023-12-04 07:10:12,248 [INFO ]  Current val loss of 0.04477 < than val loss of 0.07203, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2023-12-04 07:10:14,570 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2023-12-04 07:10:14,624 [INFO ]  epoch: 4 loss: 0.3878 mse: 0.0009576 mae: 0.004967 val_loss: 0.04477 val_mse: 0.0002073 val_mae: 0.003184
2023-12-04 07:10:15,759 [INFO ]  Reshuffling training dataset.
2023-12-04 09:47:59,438 [INFO ]  Running test loop after epoch: 5.
2023-12-04 09:55:58,708 [INFO ]  epoch: 5 loss: 0.3609 mse: 0.00084 mae: 0.004631 val_loss: 0.06786 val_mse: 0.0001863 val_mae: 0.002842
2023-12-04 09:56:00,109 [INFO ]  Reshuffling training dataset.
2023-12-04 12:33:50,269 [INFO ]  Running test loop after epoch: 6.
2023-12-04 12:41:50,118 [INFO ]  epoch: 6 loss: 0.3436 mse: 0.0007548 mae: 0.004371 val_loss: 0.04643 val_mse: 0.0002185 val_mae: 0.002371
2023-12-04 12:41:51,877 [INFO ]  Reshuffling training dataset.
2023-12-04 15:20:01,599 [INFO ]  Running test loop after epoch: 7.
2023-12-04 15:28:02,208 [INFO ]  epoch: 7 loss: 0.3281 mse: 0.000692 mae: 0.004171 val_loss: 0.05238 val_mse: 0.0001878 val_mae: 0.002421
2023-12-04 15:28:04,264 [INFO ]  Reshuffling training dataset.
2023-12-04 18:06:26,986 [INFO ]  Running test loop after epoch: 8.
2023-12-04 18:14:27,272 [INFO ]  epoch: 8 loss: 0.3162 mse: 0.000641 mae: 0.003991 val_loss: 0.1525 val_mse: 0.0002105 val_mae: 0.004173
2023-12-04 18:14:29,518 [INFO ]  Reshuffling training dataset.
2023-12-04 20:52:33,798 [INFO ]  Running test loop after epoch: 9.
2023-12-04 21:00:33,990 [INFO ]  epoch: 9 loss: 0.3048 mse: 0.000604 mae: 0.003862 val_loss: 0.04857 val_mse: 0.0001928 val_mae: 0.002332
2023-12-04 21:00:36,541 [INFO ]  Reshuffling training dataset.
2023-12-04 23:38:38,393 [INFO ]  Running test loop after epoch: 10.
2023-12-04 23:46:37,960 [INFO ]  epoch: 10 loss: 0.2947 mse: 0.0005782 mae: 0.003765 val_loss: 0.04678 val_mse: 0.00018 val_mae: 0.001531
2023-12-04 23:46:40,722 [INFO ]  Early termination of training.
2023-12-04 23:46:41,991 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/washingmachine/train_transformer_loss
2023-12-05 04:12:03,027 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/washingmachine/train_transformer_mae
