2024-01-01 06:25:23,112 [INFO ]  *** Training model from scratch ***
2024-01-01 06:25:23,112 [INFO ]  Machine name: titan
2024-01-01 06:25:23,112 [INFO ]  Arguments: 
2024-01-01 06:25:23,112 [INFO ]  Namespace(appliance_name='washingmachine', model_arch='transformer', datadir='./dataset_management/refit', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=None, crop_val_dataset=None, do_not_use_distributed_training=False, resume_training=False, plot_display=False)
2024-01-01 06:25:23,112 [INFO ]  Window length: 599
2024-01-01 06:25:23,112 [INFO ]  Training dataset: ./dataset_management/refit/washingmachine/washingmachine_training_.csv
2024-01-01 06:25:23,113 [INFO ]  Validation dataset: ./dataset_management/refit/washingmachine/washingmachine_validation_H18.csv
2024-01-01 06:25:23,113 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/washingmachine/checkpoints_transformer
2024-01-01 06:25:23,113 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer
2024-01-01 06:25:23,113 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/washingmachine/history_transformer
2024-01-01 06:25:30,801 [INFO ]  There are 43.470M training samples.
2024-01-01 06:25:30,801 [INFO ]  There are 5.008M validation samples.
2024-01-01 06:25:30,801 [INFO ]  Normalized on power threshold: 0.008
2024-01-01 06:25:30,801 [INFO ]  L1 loss multiplier: 0.01
2024-01-01 06:25:30,802 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2024-01-01 06:25:30,968 [INFO ]  Number of replicas: 2.
2024-01-01 06:25:30,968 [INFO ]  Global batch size: 1024.
2024-01-01 06:25:32,769 [INFO ]  Learning rate: 0.0001
2024-01-01 06:25:34,403 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-01-01 06:25:35,784 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:36,704 [INFO ]  Collective all_reduce tensors: 44 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-01-01 06:25:36,979 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,194 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,199 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,205 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,205 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,427 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,428 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,429 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 06:25:43,430 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-01-01 09:02:30,132 [INFO ]  Running test loop after epoch: 1.
2024-01-01 09:10:27,189 [INFO ]  Current val loss of 0.08723 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2024-01-01 09:10:29,368 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2024-01-01 09:10:29,419 [INFO ]  epoch: 1 loss: 1.699 mse: 0.002197 mae: 0.0106 val_loss: 0.08723 val_mse: 0.000181 val_mae: 0.001913
2024-01-01 09:10:29,742 [INFO ]  Reshuffling training dataset.
2024-01-01 11:47:23,430 [INFO ]  Running test loop after epoch: 2.
2024-01-01 11:55:21,054 [INFO ]  Current val loss of 0.04971 < than val loss of 0.08723, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2024-01-01 11:55:23,208 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2024-01-01 11:55:23,260 [INFO ]  epoch: 2 loss: 0.5207 mse: 0.001376 mae: 0.006211 val_loss: 0.04971 val_mse: 0.0001651 val_mae: 0.001809
2024-01-01 11:55:23,821 [INFO ]  Reshuffling training dataset.
2024-01-01 14:32:29,856 [INFO ]  Running test loop after epoch: 3.
2024-01-01 14:40:27,851 [INFO ]  epoch: 3 loss: 0.4228 mse: 0.001134 mae: 0.005392 val_loss: 0.08648 val_mse: 0.0002167 val_mae: 0.002496
2024-01-01 14:40:28,738 [INFO ]  Reshuffling training dataset.
2024-01-01 17:17:40,249 [INFO ]  Running test loop after epoch: 4.
2024-01-01 17:25:38,571 [INFO ]  Current val loss of 0.04846 < than val loss of 0.04971, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer.
2024-01-01 17:25:40,792 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_transformer/assets
2024-01-01 17:25:40,847 [INFO ]  epoch: 4 loss: 0.3834 mse: 0.000963 mae: 0.004891 val_loss: 0.04846 val_mse: 0.0002389 val_mae: 0.003613
2024-01-01 17:25:41,947 [INFO ]  Reshuffling training dataset.
2024-01-01 20:02:41,952 [INFO ]  Running test loop after epoch: 5.
2024-01-01 20:10:39,142 [INFO ]  epoch: 5 loss: 0.3606 mse: 0.000842 mae: 0.00455 val_loss: 0.1571 val_mse: 0.000214 val_mae: 0.003741
2024-01-01 20:10:40,514 [INFO ]  Reshuffling training dataset.
2024-01-01 22:47:44,688 [INFO ]  Running test loop after epoch: 6.
2024-01-01 22:55:42,555 [INFO ]  epoch: 6 loss: 0.3411 mse: 0.0007471 mae: 0.004282 val_loss: 0.07858 val_mse: 0.0002458 val_mae: 0.002514
2024-01-01 22:55:44,271 [INFO ]  Reshuffling training dataset.
2024-01-02 01:32:40,130 [INFO ]  Running test loop after epoch: 7.
2024-01-02 01:40:37,828 [INFO ]  epoch: 7 loss: 0.3265 mse: 0.0006825 mae: 0.004086 val_loss: 0.09878 val_mse: 0.0002088 val_mae: 0.00304
2024-01-02 01:40:39,789 [INFO ]  Reshuffling training dataset.
2024-01-02 04:17:35,447 [INFO ]  Running test loop after epoch: 8.
2024-01-02 04:25:33,006 [INFO ]  epoch: 8 loss: 0.3149 mse: 0.0006335 mae: 0.003939 val_loss: 0.05847 val_mse: 0.0002278 val_mae: 0.003376
2024-01-02 04:25:35,242 [INFO ]  Reshuffling training dataset.
2024-01-02 07:02:42,936 [INFO ]  Running test loop after epoch: 9.
2024-01-02 07:10:40,380 [INFO ]  epoch: 9 loss: 0.3052 mse: 0.0006021 mae: 0.003836 val_loss: 0.05903 val_mse: 0.0002399 val_mae: 0.002373
2024-01-02 07:10:42,854 [INFO ]  Reshuffling training dataset.
2024-01-02 09:47:52,662 [INFO ]  Running test loop after epoch: 10.
2024-01-02 09:55:50,647 [INFO ]  epoch: 10 loss: 0.2955 mse: 0.0005733 mae: 0.003731 val_loss: 0.1146 val_mse: 0.0002267 val_mae: 0.004261
2024-01-02 09:55:53,383 [INFO ]  Early termination of training.
2024-01-02 09:55:54,297 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/washingmachine/train_transformer_loss
2024-01-02 09:55:54,455 [INFO ]  Plot directory: /home/lindo/Develop/nilm/ml/models/washingmachine/train_transformer_mae
