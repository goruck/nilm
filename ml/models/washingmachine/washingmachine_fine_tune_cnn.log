2024-05-17 07:37:37,911 [INFO ]  Machine name: titan
2024-05-17 07:37:37,911 [INFO ]  Arguments: 
2024-05-17 07:37:37,911 [INFO ]  Namespace(appliance_name='washingmachine', model_arch='cnn', datadir='./dataset_management/my-house', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=None, crop_val_dataset=None, plot_display=True)
2024-05-17 07:37:37,911 [INFO ]  Window length: 599
2024-05-17 07:37:37,912 [INFO ]  Training dataset: ./dataset_management/my-house/washingmachine/washingmachine_training_house.csv
2024-05-17 07:37:37,912 [INFO ]  Validation dataset: ./dataset_management/my-house/washingmachine/washingmachine_validation_house.csv
2024-05-17 07:37:37,912 [INFO ]  Restoring model from: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn
2024-05-17 07:37:37,912 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/washingmachine/checkpoints_cnn_fine_tune
2024-05-17 07:37:37,912 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune
2024-05-17 07:37:37,912 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/washingmachine/history_cnn_fine_tune
2024-05-17 07:37:38,080 [INFO ]  There are 0.656M training samples.
2024-05-17 07:37:38,080 [INFO ]  There are 0.164M validation samples.
2024-05-17 07:37:38,080 [INFO ]  Normalized on power threshold: 0.004
2024-05-17 07:37:38,080 [INFO ]  L1 loss multiplier: 0.01
2024-05-17 07:37:38,080 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2024-05-17 07:37:38,359 [INFO ]  Number of replicas: 2.
2024-05-17 07:37:38,359 [INFO ]  Global batch size: 1024.
2024-05-17 07:37:38,412 [INFO ]  Learning rate: 0.0001
2024-05-17 07:37:38,795 [WARNI]  No training configuration found in save file, so the model was *not* compiled. Compile it manually.
2024-05-17 07:37:47,392 [INFO ]  Collective all_reduce tensors: 6 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-05-17 07:37:48,984 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:49,835 [INFO ]  Collective all_reduce tensors: 6 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-05-17 07:37:49,912 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,311 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,314 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,317 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,318 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,338 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,339 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,340 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:37:53,341 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-05-17 07:38:07,994 [INFO ]  Running test loop after epoch: 1.
2024-05-17 07:38:10,278 [INFO ]  Current val loss of 0.2155 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-05-17 07:38:10,279 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-05-17 07:38:11,495 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-05-17 07:38:11,509 [INFO ]  epoch: 1 loss: 1.218 mse: 0.0002465 mae: 0.005843 val_loss: 0.2155 val_mse: 0.0002742 val_mae: 0.00238
2024-05-17 07:38:11,763 [INFO ]  Reshuffling training dataset.
2024-05-17 07:38:26,692 [INFO ]  Running test loop after epoch: 2.
2024-05-17 07:38:28,160 [INFO ]  Current val loss of 0.1983 < than val loss of 0.2155, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-05-17 07:38:28,160 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-05-17 07:38:28,916 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-05-17 07:38:28,929 [INFO ]  epoch: 2 loss: 0.3147 mse: 8.088e-05 mae: 0.002407 val_loss: 0.1983 val_mse: 0.0002856 val_mae: 0.002059
2024-05-17 07:38:29,177 [INFO ]  Reshuffling training dataset.
2024-05-17 07:38:44,230 [INFO ]  Running test loop after epoch: 3.
2024-05-17 07:38:45,665 [INFO ]  epoch: 3 loss: 0.2253 mse: 6.797e-05 mae: 0.001959 val_loss: 0.2 val_mse: 0.0002888 val_mae: 0.001945
2024-05-17 07:38:45,953 [INFO ]  Reshuffling training dataset.
2024-05-17 07:39:00,566 [INFO ]  Running test loop after epoch: 4.
2024-05-17 07:39:01,982 [INFO ]  epoch: 4 loss: 0.1837 mse: 6.068e-05 mae: 0.001738 val_loss: 0.2138 val_mse: 0.0002983 val_mae: 0.002032
2024-05-17 07:39:02,274 [INFO ]  Reshuffling training dataset.
2024-05-17 07:39:17,404 [INFO ]  Running test loop after epoch: 5.
2024-05-17 07:39:18,839 [INFO ]  Current val loss of 0.1854 < than val loss of 0.1983, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-05-17 07:39:18,839 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-05-17 07:39:19,595 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-05-17 07:39:19,608 [INFO ]  epoch: 5 loss: 0.1589 mse: 5.641e-05 mae: 0.001631 val_loss: 0.1854 val_mse: 0.0002826 val_mae: 0.001886
2024-05-17 07:39:19,886 [INFO ]  Reshuffling training dataset.
2024-05-17 07:39:34,791 [INFO ]  Running test loop after epoch: 6.
2024-05-17 07:39:36,212 [INFO ]  epoch: 6 loss: 0.1437 mse: 5.204e-05 mae: 0.001526 val_loss: 0.1965 val_mse: 0.000286 val_mae: 0.002083
2024-05-17 07:39:36,511 [INFO ]  Reshuffling training dataset.
2024-05-17 07:39:51,566 [INFO ]  Running test loop after epoch: 7.
2024-05-17 07:39:53,011 [INFO ]  epoch: 7 loss: 0.1331 mse: 4.921e-05 mae: 0.001446 val_loss: 0.2028 val_mse: 0.0002888 val_mae: 0.00186
2024-05-17 07:39:53,322 [INFO ]  Reshuffling training dataset.
2024-05-17 07:40:07,824 [INFO ]  Running test loop after epoch: 8.
2024-05-17 07:40:09,241 [INFO ]  epoch: 8 loss: 0.124 mse: 4.769e-05 mae: 0.001395 val_loss: 0.2039 val_mse: 0.0002887 val_mae: 0.001995
2024-05-17 07:40:09,545 [INFO ]  Reshuffling training dataset.
2024-05-17 07:40:24,128 [INFO ]  Running test loop after epoch: 9.
2024-05-17 07:40:25,525 [INFO ]  epoch: 9 loss: 0.1192 mse: 4.55e-05 mae: 0.001348 val_loss: 0.1956 val_mse: 0.0002822 val_mae: 0.001926
2024-05-17 07:40:25,832 [INFO ]  Reshuffling training dataset.
2024-05-17 07:40:40,615 [INFO ]  Running test loop after epoch: 10.
2024-05-17 07:40:42,009 [INFO ]  epoch: 10 loss: 0.1119 mse: 4.244e-05 mae: 0.001306 val_loss: 0.2027 val_mse: 0.0002879 val_mae: 0.001855
2024-05-17 07:40:42,321 [INFO ]  Reshuffling training dataset.
2024-05-17 07:40:57,027 [INFO ]  Running test loop after epoch: 11.
2024-05-17 07:40:58,488 [INFO ]  epoch: 11 loss: 0.1072 mse: 4.199e-05 mae: 0.001277 val_loss: 0.2065 val_mse: 0.0002852 val_mae: 0.001991
2024-05-17 07:40:58,796 [INFO ]  Early termination of training.
