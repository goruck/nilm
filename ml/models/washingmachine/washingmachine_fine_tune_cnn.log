2024-04-21 05:53:09,887 [INFO ]  Machine name: titan
2024-04-21 05:53:09,887 [INFO ]  Arguments: 
2024-04-21 05:53:09,887 [INFO ]  Namespace(appliance_name='washingmachine', model_arch='cnn', datadir='./dataset_management/my-house', save_dir='/home/lindo/Develop/nilm/ml/models', batchsize=512, n_epoch=50, crop_train_dataset=None, crop_val_dataset=None, plot_display=True)
2024-04-21 05:53:09,887 [INFO ]  Window length: 599
2024-04-21 05:53:09,887 [INFO ]  Training dataset: ./dataset_management/my-house/washingmachine/washingmachine_training_house.csv
2024-04-21 05:53:09,887 [INFO ]  Validation dataset: ./dataset_management/my-house/washingmachine/washingmachine_validation_house.csv
2024-04-21 05:53:09,887 [INFO ]  Restoring model from: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn
2024-04-21 05:53:09,887 [INFO ]  Checkpoint file path: /home/lindo/Develop/nilm/ml/models/washingmachine/checkpoints_cnn_fine_tune
2024-04-21 05:53:09,887 [INFO ]  SaveModel file path: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune
2024-04-21 05:53:09,887 [INFO ]  Training history file path: /home/lindo/Develop/nilm/ml/models/washingmachine/history_cnn_fine_tune
2024-04-21 05:53:10,004 [INFO ]  There are 0.413M training samples.
2024-04-21 05:53:10,004 [INFO ]  There are 0.103M validation samples.
2024-04-21 05:53:10,004 [INFO ]  Normalized on power threshold: 0.004
2024-04-21 05:53:10,004 [INFO ]  L1 loss multiplier: 0.01
2024-04-21 05:53:10,004 [INFO ]  Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
2024-04-21 05:53:10,285 [INFO ]  Number of replicas: 2.
2024-04-21 05:53:10,285 [INFO ]  Global batch size: 1024.
2024-04-21 05:53:10,337 [INFO ]  Learning rate: 0.0001
2024-04-21 05:53:10,713 [WARNI]  No training configuration found in save file, so the model was *not* compiled. Compile it manually.
2024-04-21 05:53:11,510 [INFO ]  Collective all_reduce tensors: 6 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-04-21 05:53:11,791 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:12,207 [INFO ]  Collective all_reduce tensors: 6 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-04-21 05:53:12,298 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,117 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,120 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,123 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,124 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,147 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,148 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,149 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:14,150 [INFO ]  Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2024-04-21 05:53:23,910 [INFO ]  Running test loop after epoch: 1.
2024-04-21 05:53:25,367 [INFO ]  Current val loss of 0.4328 < than val loss of inf, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:53:25,368 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:53:26,187 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:53:26,207 [INFO ]  epoch: 1 loss: 2.186 mse: 0.0003364 mae: 0.008752 val_loss: 0.4328 val_mse: 0.0002525 val_mae: 0.00333
2024-04-21 05:53:26,463 [INFO ]  Reshuffling training dataset.
2024-04-21 05:53:36,315 [INFO ]  Running test loop after epoch: 2.
2024-04-21 05:53:37,306 [INFO ]  Current val loss of 0.3606 < than val loss of 0.4328, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:53:37,307 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:53:37,922 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:53:37,940 [INFO ]  epoch: 2 loss: 0.4615 mse: 7.538e-05 mae: 0.003273 val_loss: 0.3606 val_mse: 0.0002716 val_mae: 0.002696
2024-04-21 05:53:38,187 [INFO ]  Reshuffling training dataset.
2024-04-21 05:53:48,104 [INFO ]  Running test loop after epoch: 3.
2024-04-21 05:53:49,066 [INFO ]  Current val loss of 0.3189 < than val loss of 0.3606, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:53:49,066 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:53:49,671 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:53:49,689 [INFO ]  epoch: 3 loss: 0.2737 mse: 5.624e-05 mae: 0.002287 val_loss: 0.3189 val_mse: 0.0002806 val_mae: 0.002457
2024-04-21 05:53:49,945 [INFO ]  Reshuffling training dataset.
2024-04-21 05:53:59,937 [INFO ]  Running test loop after epoch: 4.
2024-04-21 05:54:00,932 [INFO ]  Current val loss of 0.2922 < than val loss of 0.3189, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:54:00,932 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:54:01,687 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:54:01,706 [INFO ]  epoch: 4 loss: 0.2028 mse: 5.108e-05 mae: 0.001918 val_loss: 0.2922 val_mse: 0.0003043 val_mae: 0.002527
2024-04-21 05:54:01,964 [INFO ]  Reshuffling training dataset.
2024-04-21 05:54:11,906 [INFO ]  Running test loop after epoch: 5.
2024-04-21 05:54:12,880 [INFO ]  Current val loss of 0.2696 < than val loss of 0.2922, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:54:12,881 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:54:13,492 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:54:13,512 [INFO ]  epoch: 5 loss: 0.1701 mse: 4.549e-05 mae: 0.001675 val_loss: 0.2696 val_mse: 0.0002646 val_mae: 0.002278
2024-04-21 05:54:13,770 [INFO ]  Reshuffling training dataset.
2024-04-21 05:54:23,651 [INFO ]  Running test loop after epoch: 6.
2024-04-21 05:54:24,612 [INFO ]  Current val loss of 0.224 < than val loss of 0.2696, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:54:24,612 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:54:25,221 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:54:25,239 [INFO ]  epoch: 6 loss: 0.1491 mse: 4.304e-05 mae: 0.001547 val_loss: 0.224 val_mse: 0.0003095 val_mae: 0.002425
2024-04-21 05:54:25,501 [INFO ]  Reshuffling training dataset.
2024-04-21 05:54:35,234 [INFO ]  Running test loop after epoch: 7.
2024-04-21 05:54:36,206 [INFO ]  Current val loss of 0.1991 < than val loss of 0.224, saving model to /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune.
2024-04-21 05:54:36,207 [WARNI]  Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-04-21 05:54:36,962 [INFO ]  Assets written to: /home/lindo/Develop/nilm/ml/models/washingmachine/savemodel_cnn_fine_tune/assets
2024-04-21 05:54:36,982 [INFO ]  epoch: 7 loss: 0.1302 mse: 4.069e-05 mae: 0.001473 val_loss: 0.1991 val_mse: 0.0002886 val_mae: 0.002356
2024-04-21 05:54:37,245 [INFO ]  Reshuffling training dataset.
2024-04-21 05:54:46,968 [INFO ]  Running test loop after epoch: 8.
2024-04-21 05:54:47,952 [INFO ]  epoch: 8 loss: 0.1208 mse: 4.004e-05 mae: 0.00141 val_loss: 0.2427 val_mse: 0.0002731 val_mae: 0.002281
2024-04-21 05:54:48,232 [INFO ]  Reshuffling training dataset.
2024-04-21 05:54:58,039 [INFO ]  Running test loop after epoch: 9.
2024-04-21 05:54:59,004 [INFO ]  epoch: 9 loss: 0.1112 mse: 3.758e-05 mae: 0.001346 val_loss: 0.2054 val_mse: 0.0002746 val_mae: 0.002278
2024-04-21 05:54:59,281 [INFO ]  Reshuffling training dataset.
2024-04-21 05:55:09,020 [INFO ]  Running test loop after epoch: 10.
2024-04-21 05:55:09,970 [INFO ]  epoch: 10 loss: 0.1051 mse: 3.708e-05 mae: 0.001327 val_loss: 0.2196 val_mse: 0.0002978 val_mae: 0.002312
2024-04-21 05:55:10,247 [INFO ]  Reshuffling training dataset.
2024-04-21 05:55:19,868 [INFO ]  Running test loop after epoch: 11.
2024-04-21 05:55:20,893 [INFO ]  epoch: 11 loss: 0.1037 mse: 3.623e-05 mae: 0.001259 val_loss: 0.2446 val_mse: 0.0002729 val_mae: 0.002345
2024-04-21 05:55:21,185 [INFO ]  Reshuffling training dataset.
2024-04-21 05:55:31,010 [INFO ]  Running test loop after epoch: 12.
2024-04-21 05:55:31,996 [INFO ]  epoch: 12 loss: 0.09487 mse: 3.491e-05 mae: 0.001217 val_loss: 0.2217 val_mse: 0.0002945 val_mae: 0.002487
2024-04-21 05:55:32,278 [INFO ]  Reshuffling training dataset.
2024-04-21 05:55:42,107 [INFO ]  Running test loop after epoch: 13.
2024-04-21 05:55:43,062 [INFO ]  epoch: 13 loss: 0.09592 mse: 3.365e-05 mae: 0.001202 val_loss: 0.2429 val_mse: 0.0002799 val_mae: 0.002452
2024-04-21 05:55:43,342 [INFO ]  Early termination of training.
